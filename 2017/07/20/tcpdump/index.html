<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="TCPdump Command"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="TCPdump Command &middot; Seacme Huang" />
  	<meta property="og:site_name" content="Seacme Huang" />
  	<meta property="og:url" content="http://huang901111.github.io/2017/07/20/tcpdump/" />

    
        
            <meta property="og:image" content="http://oskduq7mi.bkt.clouddn.com/cover_polenord.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2017-07-20T00:00:00Z" />

    
    <meta property="article:tag" content="Linux" />
    
    

    <title>TCPdump Command &middot; Seacme Huang</title>

    
    <meta name="description" content="&lt;p&gt;&lt;left&gt;&lt;font color=#D3D3D3 size=5&gt;Linux版wireshark抓包功能工具&lt;/font&gt;&lt;/left&gt; &lt;/p&gt;" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    

    

    
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Seacme Huang" />
      
      
    
    <meta name="generator" content="Hugo 0.24.1" />

    <link rel="canonical" href="http://huang901111.github.io/2017/07/20/tcpdump/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "",
        "logo": "http://huang901111.github.io/images/touxiang.png"
    },
    "author": {
        "@type": "Person",
        "name": "",
        
        "image": {
            "@type": "ImageObject",
            "url": "http://huang901111.github.io/images/touxiang.png",
            "width": 250,
            "height": 250
        }, 
        
        "url": "http://sa.seacme.cn",
        "sameAs": [
            
            
             
             
             
             
             
            
        ],
        "description": "Lifelong learning is the best investment for ourself life."
        
    },
    "headline": "TCPdump Command",
    "name": "TCPdump Command",
    "wordCount":  649 ,
    "timeRequired": "PT4M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "http://huang901111.github.io/2017/07/20/tcpdump/",
    "datePublished": "2017-07-20T00:00Z",
    "dateModified": "2017-07-20T00:00Z",
    
    "keywords": "Linux",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://huang901111.github.io/2017/07/20/tcpdump/"
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79101-12', 'auto');
      ga('send', 'pageview');

    </script>
    

    




    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/">Blog</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/linux">Linux</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/database">Database</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/python">Python</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/network">Network</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/storage">Storage</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/windows">Windows</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/monitoring">Monitoring</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/interest">Interest</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">





<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="http://huang901111.github.io/"><img src="/images/touxiang.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">TCPdump Command</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-07-20T00:00:00Z">
            Jul 20, 2017
          </time>
        
         
          <span class="post-tag small"><a href="http://huang901111.github.io/tags/linux/">#Linux</a></span>
         
        </section>
    </header>

    <section class="post-content">
      <p><left><font color=#D3D3D3 size=5>Linux版wireshark抓包功能工具</font></left> </p>

<blockquote>
<p>一、介绍</p>
</blockquote>

<ul>
<li><code>tcpdump</code>是一个用于截取网络分组，并输出分组内容的工具，简单说是数据包抓包工具。</li>
<li><code>tcpdump</code>凭借强大的功能和灵活的截取策略，使其成为Linux系统下用于网络分析和问题排查的首选工具。</li>
<li><code>tcpdump</code>可以输出wireshark支持的cap文件打开查看</li>
</ul>

<hr />

<blockquote>
<p>二、tcpdump表达式</p>
</blockquote>

<p><code>表达式</code>是一个正则表达式，tcpdump利用它作为过滤报文的条件，如果一个报文满足表达式的条件，则这个报文将会被捕获。如果没有给出任何条件，则网络上所有的信息包将会被截获。</p>

<p><code>tcpdump</code>可以指定关键字加各种条件进行过滤。</p>

<ul>
<li><p><strong>第一种是关于类型的关键字</strong></p>

<ul>
<li>主要包括<code>host</code>、<code>net</code>、<code>port</code></li>
<li><code>host</code> 192.168.1.1，指明192.168.1.1是一台主机</li>
<li><code>net</code> 192.168.1.0，指明192.168.1.0是一个网络地址</li>
<li><code>port</code> 23 指明端口号是23</li>
<li>如果没有指定类型，缺省的类型是host
<br /></li>
</ul></li>

<li><p><strong>第二种是确定传输方向的关键字</strong></p>

<ul>
<li>主要包括<code>src</code>、<code>dst</code>、<code>dst or src</code>、<code>dst and src</code>，这些关键字指明了传输的方向</li>
<li><code>src</code>192.168.1.120，指明IP包中源地址是192.168.1.120</li>
<li><code>dst</code> 192.168.1.150，指明目的网络地址是192.168.1.150</li>
<li>如果没有指明方向关键字，则缺省是src or dst关键字
<br /></li>
</ul></li>

<li><p><strong>第三种是协议的关键字</strong></p>

<ul>
<li>主要包括<code>fddi</code>、<code>ip</code>、<code>arp</code>、<code>rarp</code>、<code>tcp</code>、<code>udp</code>等类型</li>
<li><code>fddi</code>指明是在FDDI（分布式光纤数据接口网络）上的特定的网路协议，实际上它是<code>ether</code>的别名，fddi和ether具有类似的源地址和目的地址，所以可以将fddi协议包当做ether的包进行处理和分析。</li>
<li>其他的几个关键字就是指明了监听的包的协议内容</li>
<li>如果没有指定任何协议，则tcpdump将会监听所有协议的信息包
<br /></li>
</ul></li>

<li><p><strong>其他关键字</strong></p>

<ul>
<li><code>gateway</code>、<code>broadcast</code>、<code>less</code>、<code>greater</code></li>
<li>三种逻辑运算：取非运算<code>not</code>、<code>!</code>；与运算<code>and</code>、<code>&amp;&amp;</code>；或运算<code>or</code>、<code>||</code>
<br /></li>
</ul></li>
</ul>

<hr />

<blockquote>
<p>三、tcpdump 选项</p>
</blockquote>

<table>
<thead>
<tr>
<th>选项参数</th>
<th>含义</th>
<th>选项参数</th>
<th>含义</th>
</tr>
</thead>

<tbody>
<tr>
<td>-A</td>
<td>以ASCII格式打印出所有分组，并将链路层的头最小化</td>
<td>-c</td>
<td>在收到指定的数量的分组后，tcpdump就会停止</td>
</tr>

<tr>
<td>-C</td>
<td>在将一个原始分组写入文件之前，检查文件当前的大小是否超过参数file_size中指定的大小，如果超过了指定大小，则关闭当前文件，然后打开一个新的文件</td>
<td>-d</td>
<td>将匹配信息包的代码以人们能够理解的汇编格式输出</td>
</tr>

<tr>
<td>-dd</td>
<td>将匹配信息包的代码以C语言程序段的格式输出</td>
<td>-ddd</td>
<td>将匹配信息包的代码以十进制的形式输出</td>
</tr>

<tr>
<td>-D</td>
<td>打印出系统中所有可以用tcpdump截包的网络接口</td>
<td>-e</td>
<td>在输出行打印出数据链路层的头部信息</td>
</tr>

<tr>
<td>-E</td>
<td>用spi@ipaddr algo:secret解密那些以addr作为地址，并且包含了安全参数索引值spi的IPSec ESP分组</td>
<td>-f</td>
<td>将外部的Internet地址以数字的形式打印出来</td>
</tr>

<tr>
<td>-F</td>
<td>从指定的文件中读取表达式，忽略命令行中给出的表达式</td>
<td>-i</td>
<td>指定监听的网络接口</td>
</tr>

<tr>
<td>-l</td>
<td>使标准输出变为缓冲行形式，可以把数据导出到文件</td>
<td>-L</td>
<td>列出网络接口的已知数据链路</td>
</tr>

<tr>
<td>-m</td>
<td>从文件module中导出SMI MIB模块定义。该参数可以被使用多次，以导入多个MIB模块</td>
<td>-M</td>
<td>如果tcp报文中存在TCP-MD5选项，则需要用secret作为方向的验证码用于验证TCP-MD5选项摘要</td>
</tr>

<tr>
<td>-b</td>
<td>在数据-链路层上选择协议，包括ip、arp、rarp、ipx都是这一层</td>
<td>-n</td>
<td>不把网络地址转换成名字</td>
</tr>

<tr>
<td>-nn</td>
<td>不进行端口名称的转换</td>
<td>-N</td>
<td>不输出主机名中的域名部分</td>
</tr>

<tr>
<td>-t</td>
<td>在输出的每一行不打印时间戳</td>
<td>-O</td>
<td>不运行分组匹配代码优化程序</td>
</tr>

<tr>
<td>-P</td>
<td>不将网络接口设置成混杂模式</td>
<td>-q</td>
<td>快速输出，只输出较少的协议信息</td>
</tr>

<tr>
<td>-r</td>
<td>从指定的文件中读取包</td>
<td>-S</td>
<td>将tcp的序列号以绝对值形式输出，而不是相对值</td>
</tr>

<tr>
<td>-s</td>
<td>从每个分组中读取最开始的snaplen个字节，而不是默认的68个字节</td>
<td>-T</td>
<td>将监听的包直接解释为指定的类型的报文，常见的类型有rpc远程过程调用和snmp</td>
</tr>

<tr>
<td>-t</td>
<td>不在每一行中输出时间戳</td>
<td>-tt</td>
<td>在每一行中输出非格式化的时间戳</td>
</tr>

<tr>
<td>-ttt</td>
<td>输出本行和前面一行之间的时间差</td>
<td>-u</td>
<td>输出未解码的NFS句柄</td>
</tr>

<tr>
<td>-v</td>
<td>输出一个稍微详细的信息</td>
<td>-vv</td>
<td>输出详细的报文信息</td>
</tr>

<tr>
<td>-w</td>
<td>直接将分组写入文件中，而不是不分析并打印出来</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<hr />

<blockquote>
<p>四、常见输出结果</p>
</blockquote>

<ul>
<li><strong>数据链路层头信息</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -e host ICE
21:50:12.847509 eth0 &lt; 8:0:20:79:5b:46 0:90:27:58:af:1a ip 60: h219.33357 &gt; ICE.  telne t 0:0(0) ack 22535 win 8760 (DF)
# 21:50:12是显示的时间
# 847509是ID号
# eth0 &lt; 表示从网络接口eth0接受该分组
# eth0 &gt; 表示从网络接口设备发送分组
# 8:0:20:79:5b:46是主机H291的MAC地址，表明是从源地址H219发来的分组
# 0:90:27:58:af:1a是主机ICE的MAC地址，表示该分组的目标地址是ICE
# ip 表明该分组是IP分组
# 60 是分组的长度
# h219.33357 &gt; ICE.telnet表明该分组是从主机H219的33357端口发往主机的ICE的TELNET（23）端口
# ack 22535 表明对序列号是22535包进行响应
# win 8760 表明发送窗口的大小是8760
</code></pre>

<ul>
<li><strong>ARP包的tcpdump输出信息</strong></li>
</ul>

<pre><code class="language-shell">tcpdump arp
22:32:42.802509 eth0 &gt; arp who-has route tell ICE (0:90:27:58:af:1a)
22:32:42.802902 eth0 &lt; arp reply route is-at 0:90:27:12:10:66 (0:90:27:58:af:1a)
# 22:32:42是时间戳
# 802509是ID号
# echo &gt; 表明从主机发出该分组
# arp表明是ARP请求包
# who-has route tell ICE 表明是主机ICE请求主机route的MAC地址
# 0:90:27:12:10:66是主机ICE的MAC地址
</code></pre>

<ul>
<li><strong>TCP包的输出信息</strong></li>
</ul>

<pre><code class="language-shell">tcpdump tcp
15:35:33.841798 IP ec2-176-34-102-138.eu-west-1.compute.amazonaws.com.pcsync-https &gt; 10.249.45.185.59390: Flags [R.], seq 0, ack 44268297, win 0, length 0
# 输出信息规范：src &gt; dst: flags data-seqno ack window urgent options
# src &gt; dst 表明从源地址到目的地址
# flags是TCP报文的标志信息
# R 是 RST的标志
# data-seqno 是报文中的数据顺序号
# ack 是下次期望的顺序号
# window 是接受缓存的窗口大小
# urgent 表明报文中是否有紧急指针
</code></pre>

<ul>
<li><strong>UDP包的输出信息</strong></li>
</ul>

<pre><code class="language-shell">tcpdump udp
15:45:09.539136 IP 123.58.170.102.29414 &gt; 10.249.45.185.59967: UDP, length 69
15:45:09.539309 IP 10.249.45.185.59967 &gt; 123.58.170.102.29414: UDP, length 69
# 输出信息规范：route.port1 &gt; ICE.port2: udp lenth
# route.port1 表明从主机route的port1端口发出的一个UDP报文到主机ICE的port2端口
# udp 表明类型是UDP
# length 表明包的长度
</code></pre>

<hr />

<blockquote>
<p>五、实例操作</p>
</blockquote>

<h4 id="5-1-默认启动">5.1 默认启动</h4>

<pre><code class="language-shell">tcpdump
# 普通情况下，直接启动tcpdump将监视第一个网络接口上所有流过的数据包
</code></pre>

<h4 id="5-2-监视指定网络接口的数据包">5.2 监视指定网络接口的数据包</h4>

<pre><code class="language-shell">tcpdump -i eth1
# 如果不指定网卡，默认tcpdump只会监视第一个网络接口，一般是eth0
tcpdump -i eth0 -vnn icmp
# 获取icmp协议的数据包
tcpdump -i eth0 -vnn arp
# 获取arp协议的数据包
tcpdump -i eth0 -vnn ip
# 获取ip协议的数据包
tcpdump -i eth0 -vnn udp
# 获取udp协议的数据包
tcpdump -i eth0 -vnn -w /tmp/file -c 100
# 获取记录包记录到/tmp/file文件中，当抓取100个数据包就退出
tcpdump -i eth0 -vnn -r /tmp/file tcp
# 从/tmp/file记录中读取tcp协议的数据包、
tcpdump -i eth0 -vnn -r /tmp/file host 192.168.1.58
# 从/tmp/file记录中读取包含192.168.1.58的数据包
</code></pre>

<h4 id="5-3-监视指定主机的数据包">5.3 监视指定主机的数据包</h4>

<ul>
<li><strong>截获所有进入或离开 seacme host的数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump host seacme
</code></pre>

<ul>
<li><strong>截获所有210.27.48.1的主机收到和发出的所有的分组</strong></li>
</ul>

<pre><code class="language-shell">tcpdump host 210.27.48.1
</code></pre>

<ul>
<li><strong>截取hellos与host或者与ace之间的通信</strong></li>
</ul>

<pre><code class="language-shell">tcpdump host hellos and \(hot or ace\)
</code></pre>

<ul>
<li><strong>截取主机210.27.48.1和主机210.27.48.2或210.27.48.3的通信</strong></li>
</ul>

<pre><code class="language-shell">tcpdump host 210.27.48.1 and \(210.27.48.2 or 210.27.48.3 \)
# 注意：括号前的反斜杠是必须的
</code></pre>

<ul>
<li><strong>截取ace与任何主机之间通信的IP数据包，但不包含与hellos之间的数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump ip host ace and not hellos
</code></pre>

<ul>
<li><strong>获取主机210.27.48.1除了和主机210.27.48.2之外所有主机通信的IP包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump ip host 210.27.48.1 and ! 210.27.48.2
</code></pre>

<ul>
<li><strong>截获主机hostname发送的所有流量</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -i eth0 src host hostname
</code></pre>

<ul>
<li><strong>监控所有送到主机hostname的数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -i eth0 dst host hostname
</code></pre>

<h4 id="5-4-监控指定主机和端口的数据包">5.4 监控指定主机和端口的数据包</h4>

<ul>
<li><strong>获取主机210.27.48.1接受或发出的telnet包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump tcp port 23 and host 210.27.48.1
</code></pre>

<ul>
<li><strong>获取主机192.168.228.246接收或发出的ssh包，并且不转换主机名</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -nn -n src host 192.168.228.246 and port 22 and tcp
</code></pre>

<ul>
<li><strong>获取主机192.168.228.246接受或发出的ssh包，并把mac地址一同显示</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -e src host 192.168.228.246 and port 22 and tcp -n -nn 
</code></pre>

<ul>
<li><strong>对本机的udp 123端口进行监视</strong></li>
</ul>

<pre><code class="language-shell"># 123端口为ntp的服务端口
tcpdump udp port 123
</code></pre>

<ul>
<li><strong>监听来自eth0且端口为22，目标源为192.168.1.100的数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -i etho -nn port 22 and src host 192.168.1.100 
</code></pre>

<ul>
<li><strong>获取访问目标主机172.168.70.35，eth0并且访问端口为tcp 9080</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -i eth0 dst 172.168.70.35 and tcp port 9080
</code></pre>

<ul>
<li><strong>获取主机172.16.70.35与主机192.168.43.23或者主机192.168.43.24通信报文，并且显示在控制台上</strong></li>
</ul>

<pre><code class="language-shell">tcpdump -X -s 1024 -i eth0 host \(192.168.43.23 or 192.168.43.24\) and host 172.16.70.35
</code></pre>

<h4 id="5-5-监视指定网络的数据包">5.5 监视指定网络的数据包</h4>

<ul>
<li><strong>打印本地主机与ucb-ether网络上的主机的所有通信包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump net ucb-ether
</code></pre>

<ul>
<li><strong>过滤源主机为192.168.0.1与目的网路为192.168.0.0的报头</strong></li>
</ul>

<pre><code class="language-shell">tcpdump src host 192.168.0.1 and dst net 192.168.0.0/24
</code></pre>

<ul>
<li><strong>过滤源主机物理地址为XXXX的报头</strong></li>
</ul>

<pre><code class="language-shell">tcpdump ether src XXXX and dst .....
</code></pre>

<h4 id="5-6-获取指定协议的数据包">5.6 获取指定协议的数据包</h4>

<ul>
<li><strong>获取TCP会话中的开始和结束数据包，并且数据包的源或目的不是在本地网络上</strong></li>
</ul>

<pre><code class="language-shell">tcpdump 'tcp[tcpflages] &amp; (tcp-syn|tcp-fin) != 0 and not src and dst net localhost'
</code></pre>

<ul>
<li><strong>获取所有源或目的端口是80，网络层协议为ipv4，并且含有数据，而不是SYN,FIN以及ACK-only等数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf&lt;&lt;2)) - ((tcp[12]&amp;oxf0&gt;&gt;2)) !=0'
# ip[2:2] 表示整个ip数据包的长度
# (ip[0]&amp;0xf)&lt;&lt;2 表示ip数据包包头的长度(ip[12]&amp;xf0)&gt;&gt;4代表包中IHL域
</code></pre>

<ul>
<li><strong>长度超过576字节，并且网关地址是soup的IP数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump 'gateway soup and ip[2:2] &gt; 576'
</code></pre>

<ul>
<li><strong>获取所有IP层广播或多播的数据包，但不是物理以太网的广播或多播数据报头</strong></li>
</ul>

<pre><code class="language-shell">tcpdump 'ether[0] &amp; 1 = 0 and ip[16] &gt;&gt;&gt; 224'
</code></pre>

<ul>
<li><strong>获取除&rsquo;echo request&rsquo;或者&rsquo;echo reply&rsquo;类以外的ICMP数据包</strong></li>
</ul>

<pre><code class="language-shell">tcpdump 'icmp[icmptype] != icmp-echorequest and icmp[cmptype] != icmp-echorepley'
</code></pre>

<hr />

<blockquote>
<p>六、tcpdump与wireshark</p>
</blockquote>

<p><code>wireshark</code>是windows下非常简单易用的抓包工具，但在Linux下很难找到一个好用的图形化捉包工具。
可以用tcpdump+wireshark的完美组合实现，在Linux里抓包，然后在windows里分析包</p>

<pre><code class="language-shell">tcpdump tcp -i eth1 -t -s 0 -c 100 and dst port ! 22 and src net 192.168.1.0/24 -w /tmp/target.cap
# tcp/ip/icmp/arp/udp/rarp 这些选项都要放在第一个参数的位置，用来过滤数据包的类型
# -i eth1 只抓经过接口eth1的包
# -t 不显示时间戳
# -s 0 抓取数据包时默认抓取长度为68字节，加上-s 0后可以抓到完整的数据包
# dst port ! 22 不抓取目标端口为22的数据包
# src net 192.168.1.0/24 数据包的源网络地址为192.168.1.0/24
# -w /tmp/target.cap 保存为cap文件，方便wireshark分析
</code></pre>
    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="http://huang901111.github.io/" style="background-image: url(/images/touxiang.png)"><span class="hidden">Seacme Huang's Picture</span></a>
    </figure>
    

    





<section class="author">
  <h4><a href="http://huang901111.github.io/">Seacme Huang</a></h4>
  
  <p>Lifelong learning is the best investment for ourself life.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">GuangZhou, China</span>
    <span class="author-link icon-link"><a href="http://sa.seacme.cn">http://sa.seacme.cn</a></span>
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=TCPdump%20Command&nbsp;-&nbsp;Seacme%20Huang&amp;url=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f20%2ftcpdump%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f20%2ftcpdump%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f20%2ftcpdump%2f&amp;description=TCPdump%20Command"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f20%2ftcpdump%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    


  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/2017/07/20/socat/">
          <section class="post">
              <h2>Socat Command</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/2017/07/19/pythonconfigparser/">
          <section class="post">
              <h2>Python ConfigParser模块</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Seacme Huang</a>  @ 2017</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
</body>
</html>

