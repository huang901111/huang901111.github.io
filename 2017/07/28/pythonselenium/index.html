<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Python Selenium&#43;Plantomjs模块"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="Python Selenium&#43;Plantomjs模块 &middot; Seacme Huang" />
  	<meta property="og:site_name" content="Seacme Huang" />
  	<meta property="og:url" content="http://huang901111.github.io/2017/07/28/pythonselenium/" />

    
        
            <meta property="og:image" content="http://oskduq7mi.bkt.clouddn.com/cover_polenord.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2017-07-28T00:00:00Z" />

    
    <meta property="article:tag" content="Python" />
    
    

    <title>Python Selenium&#43;Plantomjs模块 &middot; Seacme Huang</title>

    
    <meta name="description" content="&lt;p&gt;&lt;left&gt;&lt;font color=#D3D3D3 size=5&gt;Python爬虫利器三之Selenium&#43;Plantomjs库&lt;/font&gt;&lt;/left&gt; &lt;/p&gt;" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    

    

    
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Seacme Huang" />
      
      
    
    <meta name="generator" content="Hugo 0.24.1" />

    <link rel="canonical" href="http://huang901111.github.io/2017/07/28/pythonselenium/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "",
        "logo": "http://huang901111.github.io/images/touxiang.png"
    },
    "author": {
        "@type": "Person",
        "name": "",
        
        "image": {
            "@type": "ImageObject",
            "url": "http://huang901111.github.io/images/touxiang.png",
            "width": 250,
            "height": 250
        }, 
        
        "url": "http://sa.seacme.cn",
        "sameAs": [
            
            
             
             
             
             
             
            
        ],
        "description": "Lifelong learning is the best investment for ourself life."
        
    },
    "headline": "Python Selenium+Plantomjs模块",
    "name": "Python Selenium+Plantomjs模块",
    "wordCount":  697 ,
    "timeRequired": "PT4M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "http://huang901111.github.io/2017/07/28/pythonselenium/",
    "datePublished": "2017-07-28T00:00Z",
    "dateModified": "2017-07-28T00:00Z",
    
    "keywords": "Python",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://huang901111.github.io/2017/07/28/pythonselenium/"
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79101-12', 'auto');
      ga('send', 'pageview');

    </script>
    

    




    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/">Blog</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/linux">Linux</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/database">Database</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/python">Python</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/network">Network</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/storage">Storage</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/windows">Windows</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/monitoring">Monitoring</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/tags/interest">Interest</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">





<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="http://huang901111.github.io/"><img src="/images/touxiang.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Python Selenium&#43;Plantomjs模块</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-07-28T00:00:00Z">
            Jul 28, 2017
          </time>
        
         
          <span class="post-tag small"><a href="http://huang901111.github.io/tags/python/">#Python</a></span>
         
        </section>
    </header>

    <section class="post-content">
      <p><left><font color=#D3D3D3 size=5>Python爬虫利器三之Selenium+Plantomjs库</font></left> </p>

<blockquote>
<p>一、关于Selenium</p>
</blockquote>

<ul>
<li><p><code>Selenium</code> 是一个Web自动化测试工具，可以在多平台下操作多种浏览器进行各种动作，比如运行浏览器，访问页面，点击按钮，提交表单,浏览器窗口调整，鼠标右键和拖放动作，下拉框和对话框处理等，算是QA自动化测试的必备工具。</p></li>

<li><p>抓取选用它，主要是 <code>Selenium</code> 可以渲染页面，运行页面中的JS，以及其点击按钮，提交表达等操作</p></li>

<li><p>因为 <code>Selenium</code> 会渲染页面，所以相对于requests+BeautifulSoup会慢一点。</p></li>
</ul>

<hr />

<blockquote>
<p>二、关于Phantomjs</p>
</blockquote>

<ul>
<li><p><code>Phantomjs</code> 可以看作一个没有页面的浏览器，有渲染引擎（QtWebkit）和JS引擎（JavaScriptCore）。</p></li>

<li><p><code>Phantomjs</code> 有DOM渲染，JS运行，网络访问，网页截图等多个功能。</p></li>

<li><p>使用 <code>Phantomjs</code>，而不用Chromedriver和firefox，主要是因为Phantomjs的静默方式（后台运行，不打开浏览器）</p></li>
</ul>

<hr />

<p><font color=red><strong>注意</strong>：</font></p>

<ol>
<li>常规浏览器每次访问网站都会调用浏览器，打开界面，致使脚本不能运行在后台，无法集成到脚本自动运行。</li>
<li>不过,有一个强大的无界面浏览器 <code>Phantomjs</code> ，配合 <code>Selenium</code> 使用，就可以抓取网站通过js加载的数据，『所见即所得』。</li>
</ol>

<hr />

<blockquote>
<p>三、Selenium与Phantomjs安装</p>
</blockquote>

<h4 id="3-1-selenium安装">3.1 Selenium安装</h4>

<pre><code class="language-shell">pip install -U Selenium
</code></pre>

<h4 id="3-2-phantomjs安装">3.2 Phantomjs安装</h4>

<pre><code class="language-shell">cd /data/backup/tmp/
wget -c &quot;https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-2.1.1-linux-x86_64.tar.bz2&quot; 
tar -xvf phantomjs-2.1.1-linux-x86_64.tar.bz2
cd phantomjs-2.1.1-linux-x86_64
cp -v bin/phantomjs /usr/local/bin/phantomjs
</code></pre>

<hr />

<blockquote>
<p>四、Selenium常用函数和属性</p>
</blockquote>

<h4 id="4-0-使用时的注意项">4.0 使用时的注意项</h4>

<ol>
<li><code>Selenium</code> 提供了两种对象：<code>WebDriver</code> 和 <code>WebElement</code> 这两种对象都可以使用这些API</li>
<li>这些API一旦执行失败（即查不到），就会抛出异常。因此必须用 <code>try...except</code>机制避免错误的行为影响程序继续进行</li>
<li><code>WebDriver</code> 调用以上API进行全局定位，WebElement调用以上API可以进行层级定位，即查找当前元素的子元素</li>
</ol>

<h4 id="4-1-webdriver-api">4.1 WebDriver API</h4>

<ul>
<li><strong>调用不同的浏览器</strong></li>
</ul>

<pre><code class="language-python">Brower = webdriver.Firefox()
Brower = webdriver.Chrome()
Brower = webdriver.Ie()
Brower = webdriver.Opera()
Brower = webdriver.Phantomjs()
</code></pre>

<ul>
<li><strong>设置等待网页加载时间</strong></li>
</ul>

<pre><code class="language-python">Brower.set_page_load_timeout(seconds)
# 在一些情况下，某些网页资源未正常加载，可以设置一个等待时间，不让driver卡在加载中
</code></pre>

<ul>
<li><strong>设置JS脚本或者DOM加载超时时间</strong></li>
</ul>

<pre><code class="language-python">Brower.implicitly_wait(seconds)
</code></pre>

<ul>
<li><strong>获取当前加载页面的URL</strong></li>
</ul>

<pre><code class="language-python">Brower.curren_url()
</code></pre>

<ul>
<li><strong>在当前窗口加载URL</strong>
<br /></li>
</ul>

<pre><code class="language-python">Brower.get(url)
</code></pre>

<ul>
<li><strong>刷新当前页面</strong></li>
</ul>

<pre><code class="language-python">Brower.refresh()
</code></pre>

<ul>
<li><strong>关闭当前窗口，如果当前窗口是最后一个窗口，浏览器关闭</strong></li>
</ul>

<pre><code class="language-python">Brower.close()
</code></pre>

<ul>
<li><strong>关闭所有窗口并停止WebDriver的执行</strong></li>
</ul>

<pre><code class="language-python">Brower.quit()
</code></pre>

<ul>
<li><strong>其他操作</strong></li>
</ul>

<pre><code class="language-python"># 为当前会话添加cookie
Brower.add_cookie(cookie_dict)
# 得到执行cookie
Brower.get_cookie(name)
# 得到所有cookie
Brower.get_cookies()
# 删除当前会话的所有cookie
Brower.detele_all_cookies()
# 删除指定cookie
Brower.delete_cookie(name)
# 浏览器后退历史记录
Brower.back()
# 浏览器前进历史记录
Brower.forward()
# 网页源码
Brower.page_source
# 当前页面的title
Brower.titile
# 当前浏览器的名字
Brower.name
</code></pre>

<h4 id="4-2-webelement-api">4.2 WebElement API</h4>

<ul>
<li><strong>清楚元素的内容，假如这个元素是一个文本元素</strong></li>
</ul>

<pre><code class="language-python">webEle.clear()
</code></pre>

<ul>
<li><strong>点击当前元素</strong></li>
</ul>

<pre><code class="language-python">webEle.click()
</code></pre>

<ul>
<li><strong>当前元素是否可见</strong></li>
</ul>

<pre><code class="language-python">webEle.is_displayed()
</code></pre>

<ul>
<li><strong>当前元素是否禁止，比如经常会禁用一些元素的点击</strong></li>
</ul>

<pre><code class="language-python">webEle.is_enabled()
</code></pre>

<ul>
<li><strong>当前元素是否选中，文本输入框的内容</strong></li>
</ul>

<pre><code class="language-python">webEle.is_selected()
</code></pre>

<ul>
<li><strong>向当前元素模拟键盘事件</strong></li>
</ul>

<pre><code class="language-python">webEle.send_keys(*value)
</code></pre>

<ul>
<li><strong>提交表单</strong></li>
</ul>

<pre><code class="language-python">webEle.submit()
</code></pre>

<ul>
<li><strong>当前元素的标签名</strong></li>
</ul>

<pre><code class="language-python">webEle.tag_name
</code></pre>

<ul>
<li><strong>当前元素的内容</strong></li>
</ul>

<pre><code class="language-python">webEle.text
</code></pre>

<ul>
<li><strong>获取当前元素执行属性的值</strong></li>
</ul>

<pre><code class="language-python">webEle.get_attribute(name)
</code></pre>

<hr />

<blockquote>
<p>五、定位操作</p>
</blockquote>

<ol>
<li><p>使用 <code>Brower.find_element_by_xx()</code> 得到的是一个 <code>WebElement</code> 实例，使用获得的实例调用API既可进行层级查找</p></li>

<li><p>使用 <code>Brower.find_elements_by_xx()</code> 得到的是一个元素 <code>WebElement</code> 实例的List，通过对List的遍历，即可对各个实例进行相应的操作</p></li>
</ol>

<h4 id="5-1-返回一个匹配元素-即一个webelement-元素">5.1 返回一个匹配元素，即一个WebElement<code>元素</code></h4>

<pre><code class="language-python">find_element_by_id()
# 通用id查找元素
find_element_by_name()
# 通过Name查找元素
find_element_by_class_name()
# 通过Class name定位元素
find_element_by_tag_name()
# 通过标签名查找元素
find_element_by_link_text()
# 通过链接文本获取超链接
find_element_by_partial_link_text()
# 通过链接文件匹配获取超链接
find_element_by_xpath()
# 通过XPATH查找元素
# 注意：在WebDriver里使用XPATH需要注意，如果有多个元素满足查询，将只有第一个满足条件的被返回。
find_element_by_css_selector()
# 通过CSS选择器查找元素
</code></pre>

<h4 id="5-2-返回一个列表-包含所有匹配的元素-即一个webelement-列表">5.2 返回一个列表，包含所有匹配的元素，即一个WebElement<code>列表</code></h4>

<pre><code>find_elements_by_id()
find_elements_by_name()
find_elements_by_class_name()
find_elements_by_tag_name()
find_elements_by_link_text()
find_elements_by_partial_link_text()
find_elements_by_xpath()
find_elements_by_css_selector()
</code></pre>

<hr />

<blockquote>
<p>六、父子、兄弟、相邻节点定位方式详解</p>
</blockquote>

<h4 id="6-1-父节点定位子节点">6.1 父节点定位子节点</h4>

<pre><code class="language-html">&lt;html&gt;
&lt;body&gt;
&lt;div id=&quot;A&quot;&gt;
    &lt;!--父节点定位子节点--&gt;
    &lt;div id=&quot;B&quot;&gt;
        &lt;div&gt;parent to child&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<ul>
<li><strong>根据B节点定位无id的子节点</strong></li>
</ul>

<pre><code class="language-python"># -*- coding：utf-8 -*-
from selenium import webdriver
driver = webdriver.Phantomjs()
driver.get('http://xxx.xxx.com')
# 串联寻找
print driver.find_element_by_id('B').find_element_by_tag_name('div').text
# xpath 父子关系寻找
print driver.find_element_by_xpath(&quot;//div[@id='B']/div&quot;).text
# css selector 父子关系寻找
print driver.find_element_by_css_selector('div#B&gt;div').text
# css selector nth-child
print driver.find_element_by_css_selector('div#B div:nth-child(1)').text
# nth-child(n) 该选择器返回第n个节点，该节点为div标签
# css selector nth-of-type
print driver.find_element_by_css_selector('div#B div:nth-of-type(1)').text
# nth-of-type(n) 该选择器返回第n个div标签
# xpath 轴child
print driver.find_element_by_xpath(&quot;//div[@id='B']/child::div&quot;).text
driver.quit()
</code></pre>

<h4 id="6-2-由子节点定位父节点">6.2 由子节点定位父节点</h4>

<pre><code class="language-html">&lt;html&gt;
&lt;body&gt;
&lt;div id=&quot;A&quot;&gt;
    &lt;!--子节点定位父节点--&gt;
    &lt;div&gt;
        &lt;div&gt;child to parent
            &lt;div&gt;
                &lt;div id=&quot;C&quot;&gt;&lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<ul>
<li><strong>由C节点定位其两层父节点的div</strong></li>
</ul>

<pre><code class="language-python"># -*- coding：utf-8 -*-
from selenium import webdriver
driver = webdriver.Phantomjs()
driver.get('http://xxx.xxx.com')
# xpath '.'代表当前节点;'..'代表父节点
print driver.find_element_by_xpath(&quot;//div[@id=''C]/../..&quot;).text
# xpath 轴parent
print driver.find_element_by_xpath(&quot;//div[@id='C']/parent::*/parent::div&quot;).text
# parent,取当前节点的父节点
driver.quit()
</code></pre>

<h4 id="6-3-由弟弟节点定位哥哥节点">6.3 由弟弟节点定位哥哥节点</h4>

<pre><code class="language-html">&lt;html&gt;
&lt;body&gt;
&lt;div id=&quot;A&quot;&gt;
    &lt;!--下面两个节点用于兄弟节点定位--&gt;
    &lt;div&gt;brother 1&lt;/div&gt;
    &lt;div id=&quot;D&quot;&gt;&lt;/div&gt;
    &lt;div&gt;brother 2&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<ul>
<li><strong>通过D节点定位其哥哥节点</strong></li>
</ul>

<pre><code class="language-python"># -*- coding：utf-8 -*-
from selenium import webdriver
driver = webdriver.Phantomjs()
driver.get('http://xxx.xxx.com')
# xpath 通过父节点获取其哥哥节点
print driver.find_element_by_xpath(&quot;//div[@id='D']/../div[1]&quot;).text
# xpath preceding-sibling
print driver.find_element_by_xpath(&quot;//div[@id='D']/preceding-sibling::div[1]&quot;)
.text
# 通过xpath轴：prededing-sibling，其能够获取当前节点的所有同级哥哥节点。注意括号里的标号，1代表着离当前节点最近的一个哥哥节点，数字越大表示离当前节点越远。
driver.quit()
</code></pre>

<h4 id="6-4-由哥哥节点定位弟弟节点">6.4 由哥哥节点定位弟弟节点</h4>

<pre><code class="language-html">&lt;html&gt;
&lt;body&gt;
&lt;div id=&quot;A&quot;&gt;
    &lt;!--下面两个节点用于兄弟节点定位--&gt;
    &lt;div&gt;brother 1&lt;/div&gt;
    &lt;div id=&quot;D&quot;&gt;&lt;/div&gt;
    &lt;div&gt;brother 2&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<ul>
<li><strong>通过D节点定位其弟弟节点</strong></li>
</ul>

<pre><code class="language-python"># -*- coding：utf-8 -*-
from selenium import webdriver
driver = webdriver.Phantomjs()
driver.get('http://xxx.xxx.com')
# xpath 通过父节点获取其弟弟节点
print driver.find_element_by_xpath(&quot;//div[@id='D']/../div[3]&quot;).text
# xpath 轴 following-sibling
print driver.find_element_by_xpath(&quot;//div[@id='D']/following-sibling::div[1]&quot;).text
# following-sibling 与preceding-siblingl类似，它的作用是获取当前节点的所有同级弟弟节点，1代表当前节点最近的一个弟弟节点，数字越大表示当前节点越远
# xpath 轴 following
print driver.find_element_by_xpath(&quot;//div[@id='D']/following::*&quot;).text
# following，获取到该节点之后所有节点，除了祖先节点
# css selector + 
print driver.find_element_by_css_selector('div#D + div').text
# css selector ~
print driver.find_element_by_css_selecctor('div#D ~ div').text
# + 和 ~ 的区别是：+ 表示紧跟在当前节点之后的div节点，~ 表示当前节点之后的div节点，如果用find_elements,则可获取一组div节点
driver.quit()
</code></pre>

<hr />

<blockquote>
<p>七、动态id、class定位</p>
</blockquote>

<ul>
<li><p><strong>前提</strong></p>

<ul>
<li>没有打开新页面，没有alter，没有frame，加了等待时间但是还是定位不到元素
<br /></li>
</ul></li>

<li><p><strong>结论</strong></p>

<ul>
<li>可能定位的元素的属性是动态的，即每次打开页面，这个元素的id或者class等元素属性是动态生成的。
<br /></li>
</ul></li>

<li><p><strong>判断元素是否为动态</strong></p>

<ul>
<li>一般看到的元素属性里有拼接一串数字的，很有可能是动态的。想要分辨，刷新看看元素的属性值是否发生改变
<br /></li>
</ul></li>
</ul>

<h4 id="7-1-根据其他属性定位">7.1 根据其他属性定位</h4>

<ul>
<li>如果有其他固定属性，最先考虑的当然是根据元素的其他属性来定位。
<br /></li>
</ul>

<h4 id="7-2-根据相对关系定位">7.2 根据相对关系定位</h4>

<ul>
<li>根据其附近的父节点、子节点、兄弟节点来定位
<br /></li>
</ul>

<h4 id="7-3-根据dom顺序index定位">7.3 根据DOM顺序index定位</h4>

<ul>
<li>根据该元素在主文档或者某级父节点中的index定位
<br /></li>
</ul>

<h4 id="7-4-根据部分元素属性定位">7.4 根据部分元素属性定位</h4>

<pre><code class="language-python">driver.find_element_by_xpath(&quot;//div[contains(@id, 'btn-attention')]&quot;)
# contains(a, b) 如果a中含有字符串b，则返回true，否则返回false
driver.find_element_by_xpath(&quot;//div[starts=with(@id, 'btn-attention')]&quot;)
# starts-with(a, b) 如果a是以字符串b开头，返回true，否则返回false
driver.find_element_by_xpath(&quot;//div[ends-with(@id, 'btn-attention')]&quot;)
# ends-with(a, b) 如果a是以字符串b结尾，返回true，否则返回false
</code></pre>

<hr />

<blockquote>
<p>八、selenium等待</p>
</blockquote>

<ul>
<li><p><strong>前提</strong></p>

<ul>
<li>下拉框定位不到，弹出框定位不到
<br /></li>
</ul></li>

<li><p><strong>结论</strong></p>

<ul>
<li>有frame</li>
<li>没有加等待
<br /></li>
</ul></li>
</ul>

<h4 id="8-1-强制等待-略显死板">8.1 强制等待(略显死板)</h4>

<ul>
<li>强制让闪电侠等xx时间，不管凹凸曼能不能跟上速度，还是已经提前到了，都必须等xx时间</li>
</ul>

<pre><code class="language-python"># -*- coding: utf-8 -*-
from selenium import webdriver
from time import sleep
driver = webdriver.Firefox()
driver.get('https://huilansame.github.io')
sleep(3)  # 强制等待3秒再执行下一步
print driver.current_url
driver.quit()
</code></pre>

<h4 id="8-2-隐性等待-implicitly-wait-n">8.2 隐性等待(implicitly_wait(n))</h4>

<ul>
<li>闪电侠和凹凸曼约定好，不论闪电侠去哪儿，都要等凹凸曼xx秒，如果凹凸曼在这段时间内来了，则俩人立即出发去打怪兽，如果凹凸曼在规定时间内没到，则闪电侠自己去，那自然就等着凹凸曼给你抛异常吧。</li>
</ul>

<pre><code class="language-python"># -*- coding: utf-8 -*-
from selenium import webdriver
driver = webdriver.Firefox()
driver.implicitly_wait(30)  # 隐性等待，最长等30秒
driver.get('https://huilansame.github.io')
print driver.current_url
driver.quit()
</code></pre>

<ul>
<li><code>隐性等待</code> 是设置了一个最长等待时间，如果在规定时间内网页加载完成，则执行下一步。否则一直等到时间戳止，然后执行下一步。</li>
<li><font color=red><strong>注意</strong>:</font> 这里有一个弊端，那就是程序会一直等待整个页面加载完成，也就是一般情况下你看到浏览器标签栏那个小圈不再转，才会执行下一步，但有时候页面想要的元素早就加载完成。</li>
<li><font color=red><strong>特别说明</strong>：</font>隐性等待对整个driver的周期都起作用，只需要设置一次即可。</li>
</ul>

<h4 id="8-3-显性等待-webdriverwait">8.3 显性等待(WebDriverWait)</h4>

<ul>
<li><code>WebDriverWait</code>，配合该类的until()和until_not()方法，就能够根据判断条件而进行灵活地等待了。它主要的意思就是：程序每隔xx秒看一眼，如果条件成立了，则执行下一步，否则继续等待，直到超过设置的最长时间，然后抛出TimeoutException。</li>
</ul>

<pre><code class="language-python"># -*- coding: utf-8 -*-
from selenium import webdriver
from selenium.webdriver.support.wait import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
driver = webdriver.Firefox()
driver.implicitly_wait(10)  # 隐性等待和显性等待可以同时用，但要注意：等待的最长时间取两者之中的大者
driver.get('https://huilansame.github.io')
locator = (By.LINK_TEXT, 'CSDN')
try:
    WebDriverWait(driver, 20, 0.5).until(EC.presence_of_element_located(locator))
    print driver.find_element_by_link_text('CSDN').get_attribute('href')
finally:
    driver.close()
</code></pre>

<ul>
<li>在其他操作中，隐性等待起决定性作用，在 <code>WebDriverWait</code> 中显性等待起主要作用，但要<font color=red><strong>注意</strong>：</font>最长的等待时间取决于两者之间的大者，如果隐性等待时间&gt;显性等待时间，则该句代码的最长等待时间等于隐性等待时间。</li>
</ul>

<h5 id="8-3-1-webdriverwait类">8.3.1 WebDriverWait类</h5>

<ul>
<li>wait模块的 <code>WebDriverWait</code> 类似显性等待类
<br /></li>
</ul>

<pre><code class="language-python">  selenium.webdriver.support.wait.WebDriverWait（类）

__init__
    driver: 
    # 传入WebDriver实例，即我们上例中的driver
    timeout: 
    # 超时时间，等待的最长时间（同时要考虑隐性等待时间）
    poll_frequency: 
    # 调用until或until_not中的方法的间隔时间，默认是0.5秒
    ignored_exceptions: 
    # 忽略的异常，如果在调用until或until_not的过程中抛出这个元组中的异常，
    # 则不中断代码，继续等待，如果抛出的是这个元组外的异常，则中断代码，抛出异常。默认只有NoSuchElementException。

until
    method: 
    # 在等待期间，每隔一段时间调用这个传入的方法，直到返回值不是False
    message: 
    # 如果超时，抛出TimeoutException，将message传入异常

# until_not 与until相反，until是当某元素出现或什么条件成立则继续执行，
# until_not是当某元素消失或什么条件不成立则继续执行，参数也相同，不再赘述。
    method
    message
</code></pre>

<ul>
<li><strong>基础调用方法</strong>
<br /></li>
</ul>

<pre><code class="language-python">  WebDriverWait(driver, 超时时长, 调用频率, 忽略异常).until(可执行方法, 超时时返回的信息)
  # until或until_not中的可执行的method参数
  
  # 错误用法：
  WebDriverWait(driver, 10).until(driver.find_element_by_id('kw'))
  
  # 正确用法：必须传入until或until_not可执行方法，非WebElement对象
  # selenium提供expected_conditions 模块各种条件，或者WebElement的is_displayed()、is_enabled()、is_selected()方法
</code></pre>

<h5 id="8-3-2-expected-conditions模块">8.3.2 expected_conditions模块</h5>

<ul>
<li><code>expected_conditons</code> 是 <code>selenium</code> 的一个模块，包括一系列可用于判断的条件
<br /></li>
</ul>

<pre><code class="language-python">selenium.webdriver.support.expected_conditions（模块）
# 这两个条件类验证title，验证传入的参数title是否等于或包含于driver.title
title_is
title_contains
# 这两个人条件验证元素是否出现，传入的参数都是元组类型的locator，如(By.ID, 'kw')
# 顾名思义，一个只要一个符合条件的元素加载出来就通过；另一个必须所有符合条件的元素都加载出来才行
presence_of_element_located
presence_of_all_elements_located
# 这三个条件验证元素是否可见，前两个传入参数是元组类型的locator，第三个传入WebElement
# 第一个和第三个其实质是一样的
visibility_of_element_located
invisibility_of_element_located
visibility_of
# 这两个人条件判断某段文本是否出现在某元素中，一个判断元素的text，一个判断元素的value
text_to_be_present_in_element
text_to_be_present_in_element_value
# 这个条件判断frame是否可切入，可传入locator元组或者直接传入定位方式：id、name、index或WebElement
frame_to_be_available_and_switch_to_it
# 这个条件判断是否有alert出现
alert_is_present
# 这个条件判断元素是否可点击，传入locator
element_to_be_clickable
# 这四个条件判断元素是否被选中，第一个条件传入WebElement对象，第二个传入locator元组
# 第三个传入WebElement对象以及状态，相等返回True，否则返回False
# 第四个传入locator以及状态，相等返回True，否则返回False
element_to_be_selected
element_located_to_be_selected
element_selection_state_to_be
element_located_selection_state_to_be
# 最后一个条件判断一个元素是否仍在DOM中，传入WebElement对象，可以判断页面是否刷新了
staleness_of
</code></pre>

<hr />

<blockquote>
<p>九、XPath/CSS定位速查表</p>
</blockquote>

<p><img src="http://oskduq7mi.bkt.clouddn.com/64PT7CKny1-20170727-104318.png" alt="Snip20161227_178.png" /></p>

<hr />

<blockquote>
<p>十、补充</p>
</blockquote>

<ul>
<li><strong>使用断言判断页面标题是否包含关键字</strong></li>
</ul>

<pre><code class="language-python">assert 'Python' in Brower.title
</code></pre>

<ul>
<li><strong>获取当前窗口的截图</strong></li>
</ul>

<pre><code class="language-python">from selenium import webdriver
driver = webdriver.firefox()
driver.get('http://www.python.org')
driver.save_screenshot('screenshot.png')
driver.quit()
</code></pre>
    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="http://huang901111.github.io/" style="background-image: url(/images/touxiang.png)"><span class="hidden">Seacme Huang's Picture</span></a>
    </figure>
    

    





<section class="author">
  <h4><a href="http://huang901111.github.io/">Seacme Huang</a></h4>
  
  <p>Lifelong learning is the best investment for ourself life.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">GuangZhou, China</span>
    <span class="author-link icon-link"><a href="http://sa.seacme.cn">http://sa.seacme.cn</a></span>
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Python%20Selenium%2bPlantomjs%e6%a8%a1%e5%9d%97&nbsp;-&nbsp;Seacme%20Huang&amp;url=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f28%2fpythonselenium%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f28%2fpythonselenium%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f28%2fpythonselenium%2f&amp;description=Python%20Selenium%2bPlantomjs%e6%a8%a1%e5%9d%97"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=http%3a%2f%2fhuang901111.github.io%2f2017%2f07%2f28%2fpythonselenium%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    


  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/2017/07/28/pythonglob/">
          <section class="post">
              <h2>Python Glob模块</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/2017/07/27/pythonyaml/">
          <section class="post">
              <h2>Python YAML语言</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Seacme Huang</a>  @ 2017</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
</body>
</html>

